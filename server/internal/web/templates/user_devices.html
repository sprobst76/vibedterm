{{define "user_devices.html"}}
{{template "user_layout" .}}
{{end}}

{{define "content"}}
<h1 class="page-title">Devices</h1>

{{if .Success}}<div class="alert alert-success">{{.Success}}</div>{{end}}
{{if .Error}}<div class="alert alert-error">{{.Error}}</div>{{end}}

<div class="card">
    <div class="card-header"><h2>Registered Devices</h2></div>
    <div class="card-body">
        {{if .Devices}}
        <table class="table">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Type</th>
                    <th>Last Sync</th>
                    <th>Registered</th>
                    <th class="actions-col">Actions</th>
                </tr>
            </thead>
            <tbody>
                {{range .Devices}}
                <tr>
                    <td>{{.DeviceName}}</td>
                    <td>{{.DeviceType}}</td>
                    <td>{{if .LastSyncAt}}{{timeAgo (deref .LastSyncAt)}}{{else}}<span class="text-muted">Never</span>{{end}}</td>
                    <td>{{timeAgo .CreatedAt}}</td>
                    <td class="actions-col">
                        <form action="/account/devices/{{.ID}}/delete" method="POST" class="inline-form"
                              onsubmit="return confirm('Remove this device? It will need to log in again.')">
                            <button type="submit" class="btn btn-danger btn-sm">Remove</button>
                        </form>
                    </td>
                </tr>
                {{end}}
            </tbody>
        </table>
        {{else}}
        <p class="text-muted">No devices registered yet. Connect with the VibedTerm app to register a device.</p>
        {{end}}
    </div>
</div>
{{end}}

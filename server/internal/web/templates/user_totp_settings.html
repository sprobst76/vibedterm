{{define "user_totp_settings.html"}}
{{template "user_layout" .}}
{{end}}

{{define "content"}}
<h1 class="page-title">Two-Factor Authentication</h1>

{{if .Error}}<div class="alert alert-error">{{.Error}}</div>{{end}}
{{if .Success}}<div class="alert alert-success">{{.Success}}</div>{{end}}

<div class="card">
    <div class="card-header"><h2>Disable 2FA</h2></div>
    <div class="card-body">
        <p>To disable two-factor authentication, enter your password and current TOTP code.</p>
        <form action="/account/settings/totp/disable" method="POST" style="max-width: 400px; margin-top: 1rem;"
              onsubmit="return confirm('Are you sure you want to disable 2FA?')">
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" name="password" required>
            </div>
            <div class="form-group">
                <label for="code">TOTP Code</label>
                <input type="text" id="code" name="code" required
                       pattern="[0-9]{6}" maxlength="6" class="totp-input"
                       autocomplete="one-time-code" placeholder="000000">
            </div>
            <button type="submit" class="btn btn-danger">Disable 2FA</button>
            <a href="/account/settings" class="btn btn-secondary" style="margin-left: 0.5rem;">Cancel</a>
        </form>
    </div>
</div>
{{end}}
